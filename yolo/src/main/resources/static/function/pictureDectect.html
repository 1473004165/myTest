<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>Data web</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">

      <meta name="referrer" content="no-referrer">
      <!-- bootstrap css -->
      <link rel="stylesheet" href="../css/bootstrap.min.css">
      <!-- style css -->
      <link rel="stylesheet" href="../css/style.css">
      <link rel="stylesheet" href="../css/markstest.css">
      <link rel="stylesheet" href="../css/buttom.css">
      <!-- Responsive-->
      <link rel="stylesheet" href="../css/responsive.css">
      <!-- fevicon -->
      <link rel="icon" href="images/fevicon.png" type="image/gif" />
      <!-- Scrollbar Custom CSS -->
      <link rel="stylesheet" href="../css/jquery.mCustomScrollbar.min.css">
      <!-- Tweaks for older IEs-->
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
      <!-- 引入 Vue 和 Vant 的 JS 文件 -->
      <script src="https://cdn.suoluomei.com/common/js/jquery-2.1.4.min.js"></script>
      <script src="https://cdn.suoluomei.com/common/js2.0/vue/v2.5.16/vue.js"></script>
      <script src="https://cdn.suoluomei.com/common/js2.0/npm/vant@2.2/lib/vant.min.js"></script>
   </head>
   <!-- body -->
   <body class="main-layout">
      <!-- loader  -->
      <div class="loader_bg">
         <div class="loader"><img src="../images/loading.gif" alt="#" /></div>
      </div>
      <!-- end loader -->
      <!-- header -->
      <header>
         <!-- header inner -->
         <div class="header">
            <div class="container">
               <div class="row">
                  <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                     <div class="full">
                        <div class="center-desk">
                           <div class="logo">
                              <a href="../../templates/index.html"><img src="../images/logo.png" alt="#" /></a>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                     <nav class="navigation navbar navbar-expand-md navbar-dark ">
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarsExample04">
                           <ul class="navbar-nav mr-auto">
                              <li class="nav-item active">
                                 <a class="nav-link" href="../index1.html">首页</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="pictureDectect.html"> 功能展示</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="#contact">校园部署</a>
                              </li>
                           </ul>
                        </div>
                     </nav>
                  </div>
               </div>
            </div>
            <div class="modle">
               <a class="functionmodle" href="#">图片监测</a>
               <a class="functionmodle" href="realtimeDetect.html">实时监测</a>
            </div>
         </div>
      </header>
      <!-- end header inner -->
      <!-- end header -->
      <!-- banner -->
      <section class="banner_main">
         <div class="container">
<!--            <van-tabs v-model="active" animated color="#6699ff" background="#f2f2f5"-->
<!--                        title-active-color="#6699ff" title-inactive-color="rgba(0,0,0,0.7)">-->
<!--               <van-tab title="单图检测" @click="showNoResult" color="#000">-->
                  <div class="container">
                     <div class="row">
                        <div class="col-md-6" >
                           <div class="img_preview" style="background-color: #6c757d">
                              <label class="demo-rs-label">待检测图片</label>
                              <img id="imgContainer" src="../images/pic.png" style="height: 100%;" />
                           </div>
                           <div class="text-bg">
                              <input id="upload-input" type="file" style="position: absolute; top: 0; bottom: 0; left: 0;right: 0; opacity: 0;" accept="image/*" onchange="showImg(this)" />
                              <div id="upload" style="width: 150px; vertical-align: middle;">上传图片</div>
                              <button id="detectPic">检测</button>
                           </div>
                        </div>
                        <div class="col-md-6" >
                           <div id="service1" class="Services1">
                              <div class="container">
                                 <div class="col-xl-6 col-lg6 col-md-6 col-sm-6">
                                    <div class="Services-box">
                                       <i><img src="../images/service1.png" alt="#" /></i>
                                       <span id="suppose">应到人数：</span>
                                       <input id="supposeNum" type="text">
                                    </div>
                                 </div>
                                 <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                                    <div class="Services-box">
                                       <i><img src="../images/service4.png" alt="#" /></i>
                                       <span id="attendance">实到人数：</span>
                                    </div>
                                 </div>
                                 <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6">
                                    <div class="Services-box">
                                       <i><img src="../images/service5.png" alt="#" /></i>
                                       <span id="absence">缺勤人数：</span>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
<!--               </van-tab>-->
<!--               </van-tabs>-->
         </div>
         <div class="contact1" style="padding-top: 10px; font-family: Poppins;">
            <div class="container">
               <div class="row">
                  <div class="col-md-6 offset-md-3 ">
                     <form class="main_form1" style="padding: 10px 55px;border-style: solid;border-radius: 30px;: 0.5px;border-color: #ffffff;background: #0c0f38;">
                        <span style="color: #ffffff;">团队介绍</span><br>
                        <p style="color: #ffffff;">海南省海口市美兰区人民街道58号海南大学<br>
                           团队成员：叶翔乐、杨子硕、冉翔<br>
                           电话：13006084610<br>
                           邮箱15263526059@163.com
                        </p>
                     </form>
                  </div>
               </div>
            </div>
         </div>
      </section>
      <!-- end banner -->
      <!-- contact -->

      <!-- end footer -->
      <!-- Javascript files-->
      <script src="../js/jquery.min.js"></script>
      <script src="../js/popper.min.js"></script>
      <script src="../js/bootstrap.bundle.min.js"></script>
      <script src="../js/jquery-3.0.0.min.js"></script>
      <script src="../js/plugin.js"></script>
      <!-- sidebar -->
      <script src="../js/jquery.mCustomScrollbar.concat.min.js"></script>
      <script src="../js/custom.js"></script>
      <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
      <script type="text/javascript">

         function showImg(input) {
            var file = input.files[0];
            var reader = new FileReader()
            // 图片读取成功回调函数
            reader.onload = function(e) {
               document.getElementById('imgContainer').src=e.target.result
            }
            reader.readAsDataURL(file)
         }

         var supposeNum = 0;
         var attendanceNum = 0;
         var absenceNum = 0;
         var picDetect = '';

         // document.getElementById('upload-input').addEventListener('click', uploadPic)
         // function uploadPic() {
         //
         // }

         document.getElementById('detectPic').addEventListener('click', getNum)
         function getNum() {
            var param = new FormData();
            param.append('file',$("#upload-input")[0].files[0])
            $.ajax({
               url: 'http://127.0.0.1:8888/analysisImage',
               type: "post",
               contentType: false,
               async: false,
               processData: false,
               data: param,
               success: function (data){
                  attendanceNum = data.peonum;
                  picDetect = data.saveDir;
                  console.log('返回的数据：'+JSON.stringify(data));
                  document.getElementById('imgContainer').src=picDetect
                  supposeNum = document.getElementById("supposeNum").value;
                  absenceNum = supposeNum - attendanceNum;
                  document.getElementById("attendance").innerText = "实到人数："+attendanceNum;
                  document.getElementById("absence").innerText = "未到人数："+absenceNum;
               }
            });
         }



         // document.getElementById('detectPic').addEventListener('click', getNum)
         // function getNum() {
         //    attendanceNum = 25;
         //    supposeNum = document.getElementById("supposeNum").value;
         //    absenceNUm = supposeNum - attendanceNum;
         //    console.log(supposeNum, absenceNUm);
         //    document.getElementById("attendance").innerText = "实到人数："+attendanceNum;
         //    document.getElementById("absence").innerText = "未到人数："+absenceNUm;
         // }
      </script>
   <style>
</style>
</body>
</html>

